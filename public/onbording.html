<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>온보딩 | 매일 10분 과학</title>

    <!-- 외부 스타일시트 -->
    <link rel="stylesheet" href="style.css" />

    <!-- 온보딩 전용 CSS 및 스타 배경 직접 삽입 -->
    <style>
        /* 흐르는 별 배경 */
        body {
            position: relative;
            overflow: hidden;
        }

        .star-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .star {
            position: absolute;
            top: var(--y);
            left: var(--x);
            width: var(--size);
            height: var(--size);
            background: white;
            border-radius: 50%;
            opacity: var(--opa);
            animation: float var(--dur) linear var(--delay) infinite;
        }

        @keyframes float {
  from {
    transform: translate(var(--x), var(--y));
  }
  to {
    transform: translate(calc(var(--x) - 20vw), -200vh);
  }
}

        /* 온보딩 공통 */
        .hidden {
            display: none !important;
        }

        .stepper {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .step-indicator {
            width: 1rem;
            height: 1rem;
            border-radius: 50%;
            background: #ddd;
            transition: background 0.3s ease;
        }

            .step-indicator.active {
                background: #4caf50;
            }

        .onboard-box .step {
            display: none;
        }

            .onboard-box .step.active {
                display: block;
            }

        /* 기능 리스트 */
        .feature-list {
            list-style: none;
            padding: 0;
            margin: 1rem 0;
        }

            .feature-list li {
                margin: 0.5rem 0;
                font-size: 1.1rem;
            }

        .feature-img {
            display: inline-block;
            margin-left: 0.5rem;
            vertical-align: middle;
            animation: fadeIn 1s ease-in-out;
        }

        /* 포인트 카드 */
        .points-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .points-card {
            background: #fff;
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.5s forwards;
        }

        /* 날짜/시간/요일/폼 */
        .date-range, .time-range, .unit-list, #middleLevel, #highLevel {
            margin: 1rem 0;
        }

        .weekday-select {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin: 1rem 0;
        }

            .weekday-select label {
                display: flex;
                align-items: center;
                gap: 0.25rem;
            }

        .form-group {
            margin: 0.5rem 0;
        }

        .subunits {
            margin-left: 1rem;
        }

        /* 요약 리스트 */
        .summary-list {
            list-style: none;
            padding: 0;
            margin: 1rem 0;
        }

            .summary-list li {
                margin: 0.5rem 0;
                font-size: 1rem;
            }

        /* 애니메이션 */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <!-- 별 배경 -->
    <div class="star-container"></div>

    <div class="main-box">
        <h1>매일 10분 과학</h1>
        <p class="subtitle">매일 떠나는 10분간의 과학 탐사</p>

        <div class="onboard-box">
            <div class="stepper">
                <span class="step-indicator active"></span>
                <span class="step-indicator"></span>
                <span class="step-indicator"></span>
                <span class="step-indicator"></span>
            </div>

            <form id="onboardForm">
                <!-- 1단계: 기능 소개 및 학습 효과 -->
                <div class="step active" data-step="1">
                    <h2>매일 10분 과학의 핵심 기능</h2>
                    <ul class="feature-list">
                        <li>🔎 AI가 내 수준에 딱 맞춘 빈칸·OX 문제 자동 생성 <span class="feature-img"><img src="/assets/ai_icon.png" alt="AI 아이콘"></span></li>
                        <li>📊 오답 태그 기반 개인별 약점 분석 및 맞춤 출제 <span class="feature-img"><img src="/assets/analysis_icon.png" alt="분석 아이콘"></span></li>
                        <li>🏆 누적 포인트·뱃지 시스템으로 동기 부여 <span class="feature-img"><img src="/assets/points_icon.png" alt="포인트 아이콘"></span></li>
                        <li>⏱️ 하루 10분, 꾸준한 학습 루틴 관리 <span class="feature-img"><img src="/assets/routine_icon.png" alt="루틴 아이콘"></span></li>
                    </ul>
                    <h3>학습 효과</h3>
                    <p>• 정확한 오답 분석으로 약점 보완<br>• 매일 쌓이는 짧은 복습으로 장기 기억 강화<br>• 게임화된 요소로 재미있게 과학 실력 업그레이드</p>
                    <h3>커뮤니티 혜택</h3>
                    <p>• 개인 포인트를 통해 우리 지역 랭킹 확인<br>• 우리 반·우리 학교 랭킹 한눈에 확인<br>• 상위 랭커에게 깜짝 놀랄만한 혜택 제공!</p>
                    <div class="buttons-vertical">
                        <button type="button" id="next1" class="btn signup">다음 ▶</button>
                    </div>
                </div>

                <!-- 2단계: 포인트 & 랭킹 확인 -->
                <div class="step" data-step="2">
                    <h2>포인트 & 랭킹 확인</h2>
                    <div class="points-grid">
                        <div class="points-card" style="animation-delay:0s">
                            <h3>나의 포인트</h3>
                            <p class="points-value" id="myPoints">0</p>
                            <p>구/군 랭킹: <span id="myRankDistrict">-</span>위</p>
                            <p>시/도 랭킹: <span id="myRankProvince">-</span>위</p>
                        </div>
                        <div class="points-card" style="animation-delay:0.2s">
                            <h3>우리 반 포인트</h3>
                            <p class="points-value" id="classPoints">0</p>
                            <p>구/군 랭킹: <span id="classRankDistrict">-</span>위</p>
                            <p>시/도 랭킹: <span id="classRankProvince">-</span>위</p>
                        </div>
                        <div class="points-card" style="animation-delay:0.4s">
                            <h3>우리 학교 포인트</h3>
                            <p class="points-value" id="schoolPoints">0</p>
                            <p>구/군 랭킹: <span id="schoolRankDistrict">-</span>위</p>
                            <p>시/도 랭킹: <span id="schoolRankProvince">-</span>위</p>
                        </div>
                    </div>
                    <div class="buttons-vertical">
                        <button type="button" id="next2" class="btn signup">다음 ▶</button>
                    </div>
                </div>

                <!-- 3단계: 학습 일정 설정 -->
                <div class="step" data-step="3">
                    <h2>학습 일정 설정</h2>
                    <div class="date-range">
                        <label for="dateStart">시작 날짜:</label>
                        <input type="date" id="dateStart" name="dateStart" required>
                        <label for="dateEnd">종료 날짜:</label>
                        <input type="date" id="dateEnd" name="dateEnd" required>
                    </div>
                    <div class="anytime-option">
                        <button type="button" id="anytimeBtn" class="btn small">아무때나</button>
                        <p id="anytimeNote" class="hint hidden">원하는 시간대 아무때나 보내줄게요!</p>
                    </div>
                    <div class="time-range hidden" id="timeRange">
                        <h3>시간 범위 설정</h3>
                        <label for="startTime">시작 시간:</label>
                        <select id="startTime" name="startTime">
                            <option>08:00</option>
                            <option>09:00</option><!-- ... -->
                        </select>
                        <label for="endTime">종료 시간:</label>
                        <select id="endTime" name="endTime">
                            <option>18:00</option>
                            <option>19:00</option><!-- ... -->
                        </select>
                    </div>
                    <h3>학습 요일 선택</h3>
                    <div class="weekday-select">
                        <label><input type="checkbox" name="weekday" value="mon">월</label>
                        <label><input type="checkbox" name="weekday" value="tue">화</label>
                        <label><input type="checkbox" name="weekday" value="wed">수</label>
                        <label><input type="checkbox" name="weekday" value="thu">목</label>
                        <label><input type="checkbox" name="weekday" value="fri">금</label>
                        <label><input type="checkbox" name="weekday" value="sat">토</label>
                        <label><input type="checkbox" name="weekday" value="sun">일</label>
                    </div>
                    <h3>문제 수 설정</h3>
                    <input type="number" id="problemCount" name="problemCount" min="1" max="100" value="10" required>
                    <div class="buttons-vertical">
                        <button type="button" id="next3" class="btn signup">다음 ▶</button>
                    </div>
                </div>

                <!-- 4단계: 학습 범위 설정 -->
                <div class="step" data-step="4">
                    <h2>학습 범위 설정</h2>
                    <div class="form-group">
                        <label for="schoolLevel">학교 단계</label>
                        <select id="schoolLevel" name="schoolLevel" required>
                            <option value="">선택하세요</option>
                            <option value="middle">중학교</option>
                            <option value="high">고등학교</option>
                        </select>
                    </div>
                    <div id="textbookSelect" class="form-group hidden">
                        <label for="textbook">교과서</label>
                        <select id="textbook" name="textbook" required>
                            <option value="">선택하세요</option>
                        </select>
                    </div>
                    <div id="middleLevel" class="hidden">
                        <div class="form-group">
                            <label for="middleGrade">학년</label>
                            <select id="middleGrade" name="middleGrade">
                                <option value="">선택하세요</option>
                                <option value="1">1학년</option>
                                <option value="2">2학년</option>
                                <option value="3">3학년</option>
                            </select>
                        </div>
                        <div id="middleUnits" class="unit-list hidden">
                            <h3>단원 선택</h3>
                            <div class="unit">
                                <label><input type="checkbox" class="unit-master" data-unit="unit1">1단원 대단원</label>
                                <div class="subunits">
                                    <label><input type="checkbox" name="unit1-sub" value="unit1-sub1">소단원1</label>
                                    <label><input type="checkbox" name="unit1-sub" value="unit1-sub2">소단원2</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="highLevel" class="hidden">
                        <div class="form-group">
                            <label for="highGrade">학년</label>
                            <select id="highGrade" name="highGrade">
                                <option value="">선택하세요</option>
                                <option value="1">1학년</option>
                                <option value="2">2학년</option>
                                <option value="3">3학년</option>
                            </select>
                        </div>
                        <div id="highGrade1" class="hidden">
                            <div class="form-group">
                                <label for="hs1Subject">과목</label>
                                <select id="hs1Subject" name="hs1Subject">
                                    <option value="">선택하세요</option>
                                    <option value="intSci1">통합과학1</option>
                                    <option value="intSci2">통합과학2</option>
                                </select>
                            </div>
                            <div id="hs1Units" class="unit-list hidden">
                                <h3>단원 선택</h3>
                                <div class="unit">
                                    <label><input type="checkbox" class="unit-master" data-unit="hs1-u1">1단원 대단원</label>
                                    <div class="subunits">
                                        <label><input type="checkbox" name="hs1-u1-sub" value="hs1-u1-sub1">소단원1</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="highGrade23" class="hidden">
                            <h3>과목별 단원 선택</h3>
                            <div class="unit-list">
                                <div class="unit">
                                    <label><input type="checkbox" class="unit-master" data-unit="physics1">물리1 대단원</label>
                                    <div class="subunits">
                                        <label><input type="checkbox" name="physics1-sub" value="p1-sub1">소단원1</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="buttons-vertical">
                        <button type="button" id="next4" class="btn signup">다음 ▶</button>
                    </div>
                </div>

                <!-- 5단계: 설정 요약 -->
                <div class="step" data-step="5">
                    <h2>설정 요약</h2>
                    <ul class="summary-list">
                        <li><strong>학교 단계:</strong> <span id="sumSchoolLevel"></span></li>
                        <li><strong>교과서:</strong> <span id="sumTextbook"></span></li>
                        <li><strong>학년:</strong> <span id="sumGrade"></span></li>
                        <li><strong>단원:</strong> <span id="sumUnits"></span></li>
                        <li><strong>학습 기간:</strong> <span id="sumDateRange"></span></li>
                        <li><strong>학습 시간:</strong> <span id="sumTimeRange"></span></li>
                        <li><strong>학습 요일:</strong> <span id="sumWeekdays"></span></li>
                        <li><strong>문제 수:</strong> <span id="sumProblemCount"></span></li>
                    </ul>
                    <div class="buttons-vertical">
                        <button type="submit" class="btn signup">시작하기 ▶</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- 온보딩 전용 JS -->
    <script>
        // 흐르는 별 생성
        window.addEventListener('load', () => {
                        const container = document.querySelector('.star-container');
                        const STAR_COUNT = 2000;
                        for (let i = 0; i < STAR_COUNT; i++) {
                                const star = document.createElement('div');
                +                star.classList.add('star');
                +                // X 위치: 0~100vw
                    +                star.style.setProperty('--x', Math.random() * 100 + 'vw');
                +                // Y 위치: -50~150vh
                    +                star.style.setProperty('--y', (Math.random() * 200 - 50) + 'vh');
                +                // 크기: 1~4px
                    +                star.style.setProperty('--size', (1 + Math.random() * 3) + 'px');
                +                // 이동 속도: 10~15초
                    +                star.style.setProperty('--dur', (10 + Math.random() * 5) + 's');
                +                // 지연 시간: 0~3초
                    +                star.style.setProperty('--delay', (Math.random() * 3) + 's');
                +                // 불투명도: 0.8~1.0
                    +                star.style.setProperty('--opa', (0.8 + Math.random() * 0.2));
                               container.appendChild(star);
                    }
                  });

        // 스텝 전환
        const steps = document.querySelectorAll('.onboard-box .step');
        const inds = document.querySelectorAll('.stepper .step-indicator');
        let cur = 1;
        function showStep(n) {
            cur = n;
            steps.forEach(s => s.classList.toggle('active', +s.dataset.step === n));
            inds.forEach((i, idx) => i.classList.toggle('active', idx + 1 === n));
        }
        document.getElementById('next1').onclick = () => showStep(2);
        document.getElementById('next2').onclick = () => showStep(3);
        document.getElementById('next3').onclick = () => showStep(4);
        document.getElementById('next4').onclick = () => { populateSummary(); showStep(5); };

        // 3단계: 아무때나 토글
        document.getElementById('anytimeBtn').onclick = () => {
            document.getElementById('anytimeNote').classList.toggle('hidden');
            document.getElementById('timeRange').classList.toggle('hidden');
        };

        // 4단계: 교과서/단원 토글
        const sl = document.getElementById('schoolLevel');
        const txs = document.getElementById('textbookSelect');
        const tx = document.getElementById('textbook');
        const ml = document.getElementById('middleLevel');
        const hl = document.getElementById('highLevel');
        const mg = document.getElementById('middleGrade');
        const hg = document.getElementById('highGrade');
        const mu = document.getElementById('middleUnits');
        const su = document.getElementById('hs1Units');
        const h23 = document.getElementById('highGrade23');
        sl.onchange = () => {
            ml.classList.toggle('hidden', sl.value !== 'middle');
            hl.classList.toggle('hidden', sl.value !== 'high');
            txs.classList.add('hidden'); mu.classList.add('hidden');
            su.classList.add('hidden'); h23.classList.add('hidden');
        };
        mg.onchange = () => {
            if (mg.value) {
                tx.innerHTML = `
              <option value="">선택하세요</option>
              <option value="korea_science">국어 과학</option>
              <option value="basic_science">기본 과학</option>
            `;
                txs.classList.remove('hidden');
            } else {
                txs.classList.add('hidden');
                mu.classList.add('hidden');
            }
        };
        tx.onchange = () => mu.classList.toggle('hidden', !tx.value);
        hg.onchange = () => {
            su.classList.add('hidden'); h23.classList.add('hidden'); txs.classList.add('hidden');
            if (hg.value === '1') {
                tx.innerHTML = `
              <option value="">선택하세요</option>
              <option value="intSci1">통합과학1</option>
              <option value="intSci2">통합과학2</option>
            `;
                txs.classList.remove('hidden');
            } else if (hg.value === '2' || hg.value === '3') {
                h23.classList.remove('hidden');
            }
        };
        document.getElementById('hs1Subject').onchange = function () {
            su.classList.toggle('hidden', !this.value);
        };

        // 5단계: 요약 채우기
        function populateSummary() {
            const p = JSON.parse(localStorage.getItem('user_profile') || '{}');
            document.getElementById('sumSchoolLevel').textContent = p.schoolLevel || '-';
            document.getElementById('sumTextbook').textContent = p.textbook || '-';
            document.getElementById('sumGrade').textContent = p.grade || '-';
            document.getElementById('sumUnits').textContent = (p.units || []).join(', ') || '-';
            document.getElementById('sumDateRange').textContent =
                p.dateStart && p.dateEnd ? `${p.dateStart} ~ ${p.dateEnd}` : '-';
            document.getElementById('sumTimeRange').textContent =
                p.anytime ? '아무때나' :
                    p.startTime && p.endTime ? `${p.startTime} ~ ${p.endTime}` : '-';
            document.getElementById('sumWeekdays').textContent = (p.weekdays || []).join(', ') || '-';
            document.getElementById('sumProblemCount').textContent = p.problemCount || '-';
        }

        // 5단계 “시작하기” 클릭
        document.querySelector('[type=submit]').onclick = e => {
            if (cur === 5) {
                e.preventDefault();
                window.location.href = 'quiz.html';
            }
        };
    </script>
</body>
</html>
