<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>íšŒì›ê°€ì… - ë§¤ì¼ 10ë¶„ ê³¼í•™</title>
  <!-- Orbitron + Noto Sans KR (ì›ë˜ í°íŠ¸ ë³µì›) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <div class="star-container"></div>

  <div class="main-box">
    <h1>íšŒì›ê°€ì…</h1>
    <p class="subtitle">ì†Œì…œ ê³„ì •ìœ¼ë¡œ ë¹ ë¥´ê²Œ ì‹œì‘í•˜ì„¸ìš”</p>

    <!-- signup.html ì¤‘ ë²„íŠ¼ ë¶€ë¶„ -->
    <div class="buttons-vertical">
      <!-- idì™€ classê°€ ë§ì•„ì•¼ í•©ë‹ˆë‹¤ -->
      <button id="google-signup-btn" class="btn social google">
        ğŸ”­ Googleë¡œ ê°€ì…
      </button>
      <button class="btn social naver">ğŸŸ¢ Naverë¡œ ê°€ì…</button>
      <button class="btn social facebook">ğŸ”µ Facebookë¡œ ê°€ì…</button>
      <button class="btn social instagram">ğŸ“¸ Instagramë¡œ ê°€ì…</button>
    </div>
  </div>

  <script>
    const container = document.querySelector('.star-container');
    const STAR_COUNT = 2000;
    for (let i = 0; i < STAR_COUNT; i++) {
      const star = document.createElement('div');
      star.className = 'star';
      star.style.setProperty('--x', Math.random() * 100 + 'vw');
      star.style.setProperty('--y', (Math.random() * 200 - 50) + 'vh');
      star.style.setProperty('--size', (1 + Math.random() * 3) + 'px');
      star.style.setProperty('--dur', (10 + Math.random() * 5) + 's');
      star.style.setProperty('--delay', (Math.random() * 3) + 's');
      star.style.setProperty('--opa', (0.8 + Math.random() * 0.2));
      container.appendChild(star);
    }
  </script>

  <!-- Firebase + Firestore ëª¨ë“ˆ ë¡œë“œ -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js';
    import {
      getAuth,
      GoogleAuthProvider,
      signInWithPopup
    } from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js';
    import {
      getFirestore,
      doc,
      setDoc
    } from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js';

    // Firebase ì„¤ì •
    const firebaseConfig = {
      apiKey: "AIzaSyBHjJw2bulmt4p5uqtSFwNiJ5rENYiMsAI",
      authDomain: "science-time-7cb8e.firebaseapp.com",
      projectId: "science-time-7cb8e",
      storageBucket: "science-time-7cb8e.firebasestorage.app",
      messagingSenderId: "999893607916",
      appId: "1:999893607916:web:5ccae72663ca5f52e0ccc9",
      measurementId: "G-G5FH9LKN51"
    };

    // Firebase ì´ˆê¸°í™”
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db   = getFirestore(app);
    const provider = new GoogleAuthProvider();

    // ê°€ì… ë²„íŠ¼ í´ë¦­ í•¸ë“¤ëŸ¬
    document
      .getElementById('google-signup-btn')
      .addEventListener('click', async (e) => {
        e.preventDefault();
        try {
          const result = await signInWithPopup(auth, provider);
          const user = result.user;

          // Firestoreì— ìœ ì € í”„ë¡œí•„ ì €ì¥
          await setDoc(doc(db, 'users', user.uid), {
            uid:      user.uid,
            name:     user.displayName,
            email:    user.email,
            photoURL: user.photoURL,
            createdAt: Date.now()
          });

          // ë¡œì»¬ì—ë„ ì €ì¥
          localStorage.setItem('user_profile', JSON.stringify({
            uid:      user.uid,
            name:     user.displayName,
            email:    user.email,
            photoURL: user.photoURL
          }));

          // ì¶”ê°€ ì •ë³´ ì…ë ¥ í˜ì´ì§€ë¡œ ì´ë™
          window.location.href = 'school_info.html';
        } catch (error) {
          console.error('Google ë¡œê·¸ì¸ ì˜¤ë¥˜', error);
          alert('êµ¬ê¸€ ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
        }
      });
  </script>
</body>
</html>
